# blobstore


## 元数据内存结构设计

## 元数据磁盘结构设计


### **与 ext4 的对比分析**

| **并发场景**      | **ext4 的锁竞争**          | **Blobstore 的解决方案**            |
| ----------------------- | -------------------------------- | ----------------------------------------- |
| **创建文件/Blob** | 块组锁、inode 锁、目录锁竞争     | 原子 ID 分配 + 预分配元数据区域           |
| **写入文件/Blob** | inode 锁（更新文件大小、块映射） | 直接偏移量写入 + 硬件原子操作             |
| **扩展文件/Blob** | 块组锁、日志锁竞争               | 预分配空间 + 异步元数据提交               |
| **元数据一致性**  | 依赖日志锁（jbd2）保证事务原子性 | 依赖硬件原子写 + 应用层显式同步（如需要） |


# spdk中断模式怎么实现的

基于epoll实现的，注册事件的时候，为每一个事件创建了一个fd，并且通过epollctl加入监听。

epoll wait超时时间设置为0
